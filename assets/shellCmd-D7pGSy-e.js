import{d as S,r as k,s as b,c as a,a as t,u as s,t as m,b as g,j as N,o as d,_ as x}from"./index-B27VgFVv.js";import{u as B,A as V}from"./bluetoothShell-DuYcK2KY.js";import{u as j}from"./bluetoothConnection-BJyjnzJ4.js";const w={class:"page"},A={class:"controls"},E=["disabled"],I=["disabled"],D={key:0},O={key:1},P={class:"controls"},T=["disabled"],q=["disabled"],J=["disabled"],R={key:0},U={key:1},W={class:"log"},$={class:"shell-container"},z=S({__name:"shellCmd",setup(F){const u=k("");async function h(r){return await(await fetch("/commands.json")).json()}const l=j(),n=B(),{notifyEntries:v,isShellOpen:c}=b(n),{isConnected:i,device:_,isSupported:C,server:p}=b(l);async function y(){if(!p.value){alert("❌ 设备未连接");return}try{const r=await p.value.getPrimaryServices();for(const e of r){console.log("🔹 Service:",e.uuid);const o=await e.getCharacteristics();for(const f of o)console.log("   ↳ Characteristic:",f.uuid,"Properties:",JSON.stringify(f.properties))}}catch(r){console.error("扫描服务/特征失败:",r),alert("❌ 扫描服务/特征失败")}}return(r,e)=>(d(),a("section",w,[e[10]||(e[10]=t("h1",null,"Web 蓝牙 Shell 调试",-1)),t("div",A,[t("button",{onClick:e[0]||(e[0]=(...o)=>s(l).connect&&s(l).connect(...o)),disabled:!s(C)||s(i)},"连接",8,E),t("button",{onClick:e[1]||(e[1]=(...o)=>s(l).disconnect&&s(l).disconnect(...o)),disabled:!s(i)},"断开",8,I),s(i)?(d(),a("span",D,"✅ 已连接: "+m(s(_)?.name||"未知设备"),1)):(d(),a("span",O,"❌ 未连接"))]),t("div",P,[t("button",{onClick:e[2]||(e[2]=(...o)=>s(n).openShell&&s(n).openShell(...o)),disabled:!s(i)||s(c)},"打开 Shell 调试",8,T),t("button",{onClick:e[3]||(e[3]=(...o)=>s(n).closeShell&&s(n).closeShell(...o)),disabled:!s(c)},"关闭 Shell 调试",8,q),t("button",{onClick:y,disabled:!s(i)}," 扫描服务/特征 ",8,J),s(c)?(d(),a("span",R,"📡 Shell 调试已打开")):(d(),a("span",U,"未打开"))]),t("div",W,[t("h3",null,[e[8]||(e[8]=g(" 接收数据 ",-1)),t("button",{onClick:e[4]||(e[4]=(...o)=>s(n).clearNotify&&s(n).clearNotify(...o))},"清除"),t("button",{onClick:e[5]||(e[5]=(...o)=>s(n).saveNotify&&s(n).saveNotify(...o))},"保存")]),t("pre",{ref:"recvBox",class:"recv-box"},m(s(v).join(`
`)),513)]),t("div",$,[e[9]||(e[9]=t("h2",null,"蓝牙命令输入",-1)),N(V,{modelValue:u.value,"onUpdate:modelValue":e[6]||(e[6]=o=>u.value=o),fetcher:h,disabled:!s(c),placeholder:"输入命令...",onEnter:e[7]||(e[7]=o=>s(n).sendData(u.value))},null,8,["modelValue","disabled"])])]))}}),L=x(z,[["__scopeId","data-v-bcc741bb"]]);export{L as default};
